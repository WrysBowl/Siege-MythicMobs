
#########################################################
## Developed by Little Room, patreon.com/littleroomdev ##
#########################################################


#### CAPRA ####

#### SUMMON ####

pentapoints:
  Skills:
  - effect:particleline{particle=reddust;amount=5;fromOrigin=true;size=1} @MIR{r=12;t=pentapoints}
  - effect:particleline{particle=smoke;amount=1;fromOrigin=true;size=2} @MIR{r=12;t=pentapoints}

capraSUMMON:
  Skills:
  - setAI{ai=false} @self
  - setgravity{g=false} @self
  - effect:particles{p=large_smoke;amount=25;speed=0;hS=.5;vS=.5;repeat=5;repeatinterval=2;size=2} @self
  - potion{type=INVISIBILITY;duration=200;level=0;p=false;force=true} @self
  - summon{t=pentapoints} @Ring{radius=4;points=5}
  - delay 30
  - throw{velocity=12;velocityY=5} @PIR{r=4}
  - delay 1
  - sound{s=littleroom_capra:littleroom.capra.summon;sc=HOSTILE} @self
  - effect:blockmask{m=fire;r=2;d=10;oa=true} @origin{yoffset=-1}
  - delay 2
  - effect:blockmask{m=fire;r=2;d=10;oa=true} @origin{yoffset=1}
  - delay 2
  - effect:blockmask{m=fire;r=2;d=10;oa=true} @origin{yoffset=2}
  - remove @children
  - summon{type=capra} @origin
  - delay 5
  - remove @self

#### GENERAL ####

capraONSPAWN:
  Skills:
  - delay 1
  - ChangePart{model=capra;part=scythe;newmodel=scythe;newpart=scythe} @self
  - stance{s=empty} @self
  - delay 5
  - skill{s=capraGLIDE} @NearestPlayer{r=6}

capraLAVA:
  Conditions:
  - blocktype WATER true
  Skills:
  - setblock{m=MAGMA;md=0} @selflocation
  
  
capraLEVELGROUND_HIGH:
  Conditions:
  - incombat true
  #- offgcd{} true
  #- onground{} true
  - stance{s=stunned} false
  TargetConditions:
  - yDiff{diff=>6} true
  Skills: 
  - gcd{ticks=140}
  - state{s=walk;r=true} @self
  - potion{type=SLOW_FALLING;duration=10;level=0;p=false} @self
  - state{s=idle;r=true} @self
  - state{s=takeoff} @self
  - delay 15
  - effect:particlering{particle=campfire_cosy_smoke;radius=2;points=32;amount=1;hS=.25;vS=0;size=3} @origin
  - effect:particles{p=falling_dust;amount=2;speed=0;hS=.25;vS=.25;repeat=5;repeatinterval=2} @self
  - throw{velocity=12;velocityY=5} @PIR{r=6}
  - lunge{velocity=0.5;velocityY=4} @Forward{f=2.0;yoffset=2.0}
  - delay 20
  #- skill{s=capraSUBJUGATE} @target
  - lunge{velocity=1;velocityY=0;repeat=2;repeatInterval=25} @target
  - skill{s=capraFLAP;repeat=2;repeatInterval=25} @self
  - delay 40
  - state{s=walk} @self
  
capraSPAWNimps:
  Conditions:
  - children{a=>0} false
  Skills:
  - summon{type=capra_imp;ctt=true} @ModelPart{m=capra;p=leftwing;offset=LOCAL;z=1.25} 


#### KICK ####
  
capraATTACK:
  Skills:
  - CancelEvent
  - skill{s=capraATTACKskill} @self

capraATTACKskill:
  Conditions:
  - stance{s=stunned} false
  - incombat true
  #- offgcd{} true
  TargetConditions:
  - targetwithin{d=2} true
  Cooldown: 2.0
  Skills:
  - gcd{ticks=50}
  - state{s=kick;li=3;lo=2} @self
  - delay 20
  - totem{ch=3;onStart=capraATTACKDamage;int=1;hR=3;md=1} @Forward{f=1.0;y=0.0}
  - delay 40
  

capraATTACKDamage:
  Skills:
  - damage{amount=70} @target
  - effect:particles{particle=block_crack;m=redstone_block;amount=45;hS=.25;vS=1;speed=.01} @target
  - effect:particles{particle=flame;amount=15;hS=.25;vS=.25;speed=.01} @origin
  - ignite{ticks=20} @target
  - throw{velocity=12;velocityY=5} @target


#### GLIDE ####

capraGLIDE:
  Cooldown: 6.0
  Conditions:
  - incombat true
  - offgcd{} true
  - stance{s=stunned} false
  TargetConditions:
  - targetwithin{d=8} false
  Skills:
  - gcd{ticks=60}
  - state{s=glide} @self
  - state{s=idle;r=true} @self
  - state{s=walk;r=true} @self
  - sound{s=littleroom_capra:littleroom.capra.glide;sc=HOSTILE} @self
  - delay 10
  - potion{type=SLOW_FALLING;duration=20;level=0;p=false} @self
  - skill{s=capraGLIDEfire;repeat=15;repeatInterval=1} @self
  - lunge{velocity=0.75;velocityY=0.0;repeat=10;repeatInterval=2} @target
  - effect:blockmask{m=fire;r=1;d=60;oa=true;repeat=5;repeatInterval=3} @self
  - delay 15
  - effect:particles{p=flame;amount=15;speed=0;hS=.25;vS=.25;repeat=5;repeatInterval=1} @ModelPart{m=capra;p=scythe;offset=LOCAL;z=2.1}
  - delay 5
  - totem{ch=3;onStart=capraGLIDEDamage;int=1;hR=3;md=1} @Forward{f=3.0;y=1.0}
  - delay 40
  - state{s=walk} @self
  
capraGLIDEDamage:
  Skills:
  - damage{a=75} @PIR{r=3}
  - throw{velocity=4;velocityY=8} @PIR{r=3}
  
  
capraGLIDEfire:
  Skills:
  - effect:particles{p=lava;amount=5;speed=0;hS=.25;vS=.25} @self
  

#### HELLFIRE ####

capraHELLFIRE:
  Cooldown: 15
  Conditions:
  - incombat true
  - offgcd{} true
  - stance{s=stunned} false
  Skills:
  - stance{s=hellfire} @self
  - effect:spin{duration=420;velocity=5} @self
  - gcd{ticks=420}
  - state{s=walk;r=true} @self
  - potion{type=SLOW_FALLING;duration=10;level=0;p=false} @self
  - state{s=idle;r=true} @self
  - state{s=takeoff} @self
  - delay 15
  - effect:particlering{particle=campfire_cosy_smoke;radius=2;points=32;amount=1;hS=.25;vS=0;size=3} @origin
  - effect:particles{p=falling_dust;amount=2;speed=0;hS=.25;vS=.25;repeat=5;repeatinterval=2} @self
  - sound{s=minecraft:entity.ender_dragon.flap;v=10;sc=HOSTILE} @self
  - throw{velocity=12;velocityY=5} @PIR{r=6}
  - lunge{velocity=0.5;velocityY=2} @Forward{f=2.0;yoffset=2.0}
  - delay 10
  - skill{s=capraFLAP;repeat=16;repeatInterval=20} @self
  - delay 20
  - skill{s=meteor;repeat=3;repeatInterval=60} @self
  - sound{s=littleroom_capra:littleroom.capra.laugh;v=2;sc=HOSTILE} @self
  - delay 340
  - state{s=walk} @self
  - stance{s=default} @self
  

capraFLAP:
  Skills:
  - state{s=walk;r=true} @self
  - state{s=idle;r=true} @self
  - look{headOnly=false;immediately=true} @Target
  - potion{type=SLOW_FALLING;duration=20;level=0;p=false} @self
  - state{s=wingflap} @self
  - delay 10
  - sound{s=minecraft:entity.ender_dragon.flap;v=10} @self
  - lunge{velocity=0.5;velocityY=.75} @forward

scythe_hONSPAWN:
  Skills:
  - delay 1
  - state{s=switch} @self ~onSpawn
  - potion{type=INVISIBILITY;duration=480;level=0;p=false} @self
  - delay 1
  - ChangePart{model=scythe;part=fx;newmodel=slashfx;newpart=slashfx} @self


meteorONSPAWN:
  Skills:
  - delay 1
  - potion{type=INVISIBILITY;duration=480;level=0;p=false} @self

meteor:
  Skills:
  - summon{type=meteortarget} @RLNTE{a=1;r=16;s=6;minr=4}
  - sound{s=littleroom_capra:littleroom.capra.meteor;sc=HOSTILE} @self
  - delay 20
  - summon{type=meteortarget} @RLNTE{a=1;r=16;s=6;minr=4}
  - sound{s=littleroom_capra:littleroom.capra.meteor;sc=HOSTILE} @self
  - delay 20
  - summon{type=meteortarget} @RLNTE{a=1;r=16;s=6;minr=4}
  - sound{s=littleroom_capra:littleroom.capra.meteor;sc=HOSTILE} @self
  - delay 20
  
meteorcometh:
  Skills:
  - projectile{bulletType=MOB;mob=meteor;onTick=meteortick;oE=meteorimpact;v=15;i=1;hR=1;vR=1;syo=48;sB=true;sso=16;mr=90;d=200} @origin
  - delay 200
  - remove @self
  

meteortick:
  Skills:
  - effect:particles{p=campfire_cosy_smoke;amount=5;speed=0;hS=.25;vS=.25} @origin
  - effect:particles{p=flame;amount=15;speed=0;hS=.25;vS=.25} @origin

meteorimpact:
  Skills:
  - effect:explosion @self
  - throw{velocity=8;velocityY=6} @PIR{r=12}
  - damage{a=120} @PIR{r=12}
  - ignite{ticks=100} @PIR{r=4}
  - effect:blockmask{m=fire;r=1;d=60;oa=true} @origin
  - effect:particles{p=flash;amount=5;speed=1} @origin
  - remove @self
 
#### DESPAIR #### 
  

capraDESPAIR:
  Cooldown: 6.0
  Conditions:
  - stance{s=stunned} false
  - incombat true
  - offgcd{} true
  TargetConditions:
  - playerwithin{d=4} true
  Skills:
  - gcd{ticks=120}
  - state{s=walk;r=true} @self
  - state{s=attack} @self
  - delay 20
  - sound{s=littleroom_capra:littleroom.capra.despair;sc=HOSTILE} @self
  - ChangePart{model=capra;part=scythe;newmodel=capra;newpart=scythe} @self
  - orbital{bulletType=MOB;mob=capra_scythe_h;oE=capraDESPAIRreturn;points=32;interval=1;duration=80;r=6;oy=2;hr=3;vr=2}
  - delay 10
  - state{s=walk} @self
  - delay 50
  - state{s=walk;r=true} @self
  - state{s=scythecatch;li=3;lo=2} @self
  - delay 25
  - state{s=walk} @self
  - effect:particles{p=large_smoke;amount=15;speed=0;hS=.25;vS=.25} @ModelPart{m=capra;p=scythe;offset=LOCAL}
  - effect:particles{p=large_smoke;amount=15;speed=0;hS=.25;vS=.25} @ModelPart{m=capra;p=scythe;offset=LOCAL;z=1}
  - effect:particles{p=large_smoke;amount=15;speed=0;hS=.25;vS=.25} @ModelPart{m=capra;p=scythe;offset=LOCAL;z=-2}
  - effect:particles{p=large_smoke;amount=15;speed=0;hS=.25;vS=.25} @ModelPart{m=capra;p=scythe;offset=LOCAL;z=2}
  - effect:particles{p=large_smoke;amount=15;speed=0;hS=.25;vS=.25} @ModelPart{m=capra;p=scythe;offset=LOCAL;z=2.1}
  - ChangePart{model=capra;part=scythe;newmodel=scythe;newpart=scythe} @self

capraDESPAIRreturn:
  Skills:
  - effect:particles{p=large_smoke;amount=15;speed=0;hS=.25;vS=.25} @ModelPart{m=scythe;p=scythe;offset=LOCAL}
  - effect:particles{p=large_smoke;amount=15;speed=0;hS=.25;vS=.25} @ModelPart{m=scythe;p=scythe;offset=LOCAL;z=1}
  - effect:particles{p=large_smoke;amount=15;speed=0;hS=.25;vS=.25} @ModelPart{m=scythe;p=scythe;offset=LOCAL;z=-2}
  - effect:particles{p=large_smoke;amount=15;speed=0;hS=.25;vS=.25} @ModelPart{m=scythe;p=scythe;offset=LOCAL;z=2}
  - effect:particles{p=large_smoke;amount=15;speed=0;hS=.25;vS=.25} @ModelPart{m=scythe;p=scythe;offset=LOCAL;z=2.1}
  
capraDESPAIRdamage:
  Skills:
  - throw{velocity=2;velocityY=3}
  - damage{a=60}
  - ignite{ticks=20}
  - effect:particles{p=flame;amount=25;speed=0;hS=.25;vS=.25} @origin
  
 
#### SUBJUGATE ####

caprachainsONSPAWN:
  Conditions:
  - stance{s=stunned} false
  Skills:
  - actionmessage{m="Capra binds you in his chains!"} @NearestPlayer{r=3}
  - forcepull{spread=0;repeat=30;repeatInterval=2} @NearestPlayer{r=3}
  - delay 60
  - remove @self

capraSUBJUGATE:
  Conditions:
  - incombat true
  Skills:
  - summon{type=caprachains} @PlayersInRadius{r=30;limit=2;sort=NEAREST}
  

#### STUN ####

capraSTUN75:
  Cooldown: 999
  Conditions:
  - stance{s=hellfire} false
  Skills:
  - sound{s=littleroom_capra:littleroom.capra.stun;sc=HOSTILE} @self
  - CancelEvent
  - stance{s=stunned} @self
  - state{s=idle;r=true} @self
  - state{s=walk;r=true} @self
  - setAI{ai=false} @self
  - state{s=stun} @self
  - delay 120
  - setAI{ai=true} @self
  - stance{s=normal} @self
  - state{s=stun;r=true} @self
  - delay 15
  - skill{s=capraHELLFIRE} @self
  
capraSTUN50:
  Cooldown: 999
  Conditions:
  - stance{s=hellfire} false
  Skills:
  - sound{s=littleroom_capra:littleroom.capra.stun;sc=HOSTILE} @self
  - CancelEvent
  - stance{s=stunned} @self
  - state{s=idle;r=true} @self
  - state{s=walk;r=true} @self
  - setAI{ai=false} @self
  - state{s=stun} @self
  - delay 120
  - setAI{ai=true} @self
  - stance{s=normal} @self
  - state{s=stun;r=true} @self
  - delay 15
  - skill{s=capraHELLFIRE} @self
  
  
capraSTUN25:
  Cooldown: 999
  Conditions:
  - stance{s=hellfire} false
  Skills:
  - sound{s=littleroom_capra:littleroom.capra.stun;sc=HOSTILE} @self
  - CancelEvent
  - stance{s=stunned} @self
  - state{s=idle;r=true} @self
  - state{s=walk;r=true} @self
  - setAI{ai=false} @self
  - state{s=stun} @self
  - delay 120
  - setAI{ai=true} @self
  - stance{s=normal} @self
  - state{s=stun;r=true} @self
  - delay 15
  - skill{s=capraHELLFIRE} @self


#### DEATH ####
 
capraDEATH:
  Skills:
  - sound{s=littleroom_capra:littleroom.capra.death;sc=HOSTILE} @self
  - delay 10
  - ChangePart{model=capra;part=scythe;newmodel=capra;newpart=scythe} @self
  - delay 15
  - damage{amount=100} @children
  - delay 30
  - effect:particlesphere{particle=large_smoke;amount=20;radius=1.5;repeat=17;repeatInterval=5;size=1} @Forward{f=0;y=0.0}
  - effect:particlering{particle=campfire_cosy_smoke;radius=1.5;points=32;amount=1;hS=0.15;vS=0.15;repeat=4;repeatInterval=5} @Forward{f=0;y=0.0}
  - effect:particlering{particle=flame;size=2;radius=1.5;points=32;amount=5;hS=0.25;vS=0.25;repeat=17;repeatInterval=5} @Forward{f=0;y=0.0}
  - effect:blockmask{m=fire;r=2;d=120;oa=true} @Forward{f=0;y=-1.0}
  - delay 100
  - effect:itemspray{item=capra_horns;amount=1;velocity=0;yv=3;d=400;ap=true} @self
  
  
##### IMP #####

capraimpPREVENTCLIP:
  Conditions:
  - altitude{h=<1} true
  Skills:
  - lunge{velocity=0;velocityY=4} @Self

capraimpSPAWN:
  Skills:
  - delay 1
  - effect:particlesphere{particle=large_smoke;amount=50;radius=1;size=2} @ModelPart{m=imp;p=imp}
  - effect:particlesphere{particle=flame;amount=50;radius=1;size=2} @ModelPart{m=imp;p=imp}
  

capraimpFLAP:
  Conditions:
  - stance{s=grabbed} false
  Skills:
  - look{headOnly=false;immediately=true;repeat=10;repeatInterval=2} @Target
  - potion{type=SLOW_FALLING;duration=20;level=0;p=false} @self
  - state{s=flap} @self
  - delay 10
  - lunge{velocity=0.75;velocityY=.75} @forward
  
capraimpGRAB:
  Conditions:
  - targetwithin{d=3} true
  - stance{s=grabbed} false
  Skills:
  - sound{s=minecraft:entity.witch.celebrate;p=2} @self
  - mounttarget @target
  - setstance{s=grabbed} @self
  - remove @MobsInRadius{r=3;types=caprachains}
  
capraimpGRABFLY:
  Conditions:
  - stance{s=grabbed} true
  Skills:
  - state{s=grab} @self
  - pull{velocity=10;repeat=10;repeatInterval=2} @target

capraimpDEATH:
  Skills:
  - delay 10
  - effect:particles{p=smoke;amount=5;speed=0;hS=.15;vS=.15;repeat=14;repeatInterval=2} @ModelPart{m=imp;p=lefthand}
  - effect:particles{p=smoke;amount=5;speed=0;hS=.15;vS=.15;repeat=14;repeatInterval=2} @ModelPart{m=imp;p=righthand}
  - effect:particles{p=flame;amount=5;speed=0;hS=.15;vS=.15;repeat=14;repeatInterval=2} @ModelPart{m=imp;p=lefthand}
  - effect:particles{p=flame;amount=5;speed=0;hS=.15;vS=.15;repeat=14;repeatInterval=2} @ModelPart{m=imp;p=righthand}
  - delay 25
  - damage{a=60} @PIR{r=6}
  - throw{velocity=3;velocityY=6} @PIR{r=6}
  - effect:particles{p=flash} @ModelPart{m=imp;p=imp}
  - effect:blockmask{m=fire;r=1;d=20;oa=true} @ModelPart{m=imp;p=imp}
  - effect:particlesphere{particle=large_smoke;amount=50;radius=1;size=2} @ModelPart{m=imp;p=imp}
  - remove @self
  
  