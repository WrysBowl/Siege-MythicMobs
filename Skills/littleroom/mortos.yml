
#########################################################
## Developed by Little Room, patreon.com/littleroomdev ##
#########################################################

### DRAGON BREATH ###

BREATHdragon:
  Conditions:
  - targetwithin{d=24} true
  - stance{s=flight} false
  Skills:
  - projectile{onTick=BREATHdragonTICK;v=12;i=1;hR=4;vR=4;hnp=true;repeat=10;repeatInterval=1;sB=false;sE=false} @target
  
BREATHdragonTICK:
  Skills:
  - effect:particles{p=soul_fire_flame;amount=20;speed=0.01;hS=0.2;vS=0.2} @origin
  - damage{a=15}
  - ignite{ticks=20}
  

### FLYING STUFF DO NOT ALTER ###

mortosTAKEFLIGHT:
  Cooldown: 1
  Conditions:
  - stance{s=flight} false
  #- targetnotwithin{d=8} true
  #- incombat true
  - outside true
  - onground true
  Skills:
  - clearThreat{} @self  
  - runaitargetselector{target=clear}
  - delay 15
  - state{s=takeoff;li=0;lo=3} @self
  - delay 20
  - effect:particlering{particle=campfire_cosy_smoke;radius=2;points=32;amount=1;hS=.25;vS=0;size=3} @origin
  - effect:particles{p=falling_dust;amount=2;speed=0;hS=.25;vS=.25;repeat=5;repeatinterval=2} @self
  - sound{s=minecraft:entity.ender_dragon.flap;v=10;sc=HOSTILE} @self
  - throw{velocity=12;velocityY=5} @PIR{r=6}
  - potion{type=SLOW_FALLING;duration=20;level=4;p=false} @self
  - lunge{velocity=0.5;velocityY=2;repeat=10;repeatInterval=1} @Forward{f=2.0;yoffset=2.0}
  - delay 10
  - setstance{stance=flight} @self
  
LANDdragon:
  Cooldown: 60
  Conditions:
  - altitude{a=>4} true
  Skills:
  - runaitargetselector{target=players}
  - skill{s=WATERCHECK;repeat=5;repeatInterval=30} @BlocksInRadius{radius=3;radiusy=32;radius=0;shape=cube;onlyair=false;noair=true}

WATERCHECK:
  Conditions:
  - onground false
  TargetConditions:
  - blocktype{type=WATER} false
  #- altitude{a=>4to24} true
  Skills:
  - potion{type=SLOW_FALLING;duration=40;level=4;p=false} @self
  - setstance{stance=land} @self
  - state{s=glide;r=true} @self
  - state{s=landingflap;li=2;lo=3} @self
  - delay 20
  - lunge{velocity=0.25;velocityY=1} @ModelPart{m=mortos;p=mortos;offset=LOCAL;z=6;x=0}
  - sound{s=minecraft:entity.ender_dragon.flap;v=10} @self

FLYMODEdragon:
  Conditions:
  - stance{s=flight} true
  Skills:
  - potion{type=SLOW_FALLING;duration=80;level=4;p=false} @self


LOWALTdragon:
  Conditions:
  - altitude{a=<8} true
  - stance{s=flight} true 
  Skills:
  - state{s=turnright;r=true} @self
  #- gcd{ticks=20} @self
  - state{s=flap;li=2;lo=3} @self
  - lunge{velocity=0.25;velocityY=.25;repeat=10;repeatInterval=2} @ModelPart{m=mortos;p=mortos;offset=LOCAL;z=6;x=0}
  #- potion{type=SLOW_FALLING;duration=40;level=0;p=false} @self
  - delay 20
  - lunge{velocity=0.5;velocityY=1{repeat=4;repeatInterval=10} @ModelPart{m=mortos;p=mortos;offset=LOCAL;z=6;x=0}
  - sound{s=minecraft:entity.ender_dragon.flap;v=10} @self

FLAPdragon:
  Conditions:
  - offgcd true
  - stance{s=flight} true
  Skills:
  - clearThreat{} @self  
  - runaitargetselector{target=clear}
  #- state{s=glide;r=true} @self
  - state{s=flap;li=3;lo=5} @self
  - lunge{velocity=0.25;velocityY=.25;repeat=10;repeatInterval=2} @ModelPart{m=mortos;p=mortos;offset=LOCAL;z=6;x=0}
  #- potion{type=SLOW_FALLING;duration=40;level=0;p=false} @self
  - delay 20
  - effect:spin{duration=1;velocity=10;repeat=10;repeatInterval=1} @self
  - lunge{velocity=0.0;velocityY=1.5} @forward
  - sound{s=minecraft:entity.ender_dragon.flap;v=10} @self

FLYINGpathcheck:
  Conditions:
  - stance{s=flight} true
  Skills:
  #- message{m="<mob.name>&f<&co> I am checking the blocks!"} @PlayersInRadius{r=30}
  - totem{c=1;oS=FLYINGpathcheckTOTEM} @ModelPart{m=mortos;p=mortos;offset=LOCAL;z=6;x=0}
  
FLYINGpathcheckTOTEM:
  Skills:
  #- effect:particlesphere{particle=reddust;color=#FF00FF;amount=200;radius=2}
  - skill{s=FLYINGobstruction} @BlocksInRadius{radius=3;radiusy=1;radius=0;shape=sphere;onlyair=false;noair=true}
  
FLYINGobstruction:
  TargetConditions:
  - blocktype{type=air,water} false
  Skills:
  - gcd{ticks=40} @self
  - lunge{velocity=0.2;velocityY=0.1;repeat=10;repeatInterval=2} @forward
  - state{s=turn;li=5;lo=3} @self
  - effect:spin{duration=1;velocity=10} @self
  
GLIDEdragon:
  Conditions:
  - altitude{a=>12} true
  - stance{s=flight} true
  - offgcd true
  Skills:
  - gcd{ticks=45} @self
  - state{s=glide;li=2;lo=3} @self
  - lunge{velocity=0.25;velocityY=0;repeat=40;repeatInterval=1} @ModelPart{m=mortos;p=mortos;offset=LOCAL;z=6;x=0}
  - effect:spin{duration=40;velocity=1} @self .25
  - effect:spin{duration=40;velocity=-2} @self .25
  
FLYINGturnaround:
  Cooldown: 3
  Conditions:
  - incombat true
  - stance{s=flight} true
  - targetnotwithin{d=32} true
  Skills:
  - gcd{ticks=40} @self
  - lunge{velocity=0.2;velocityY=0.1;repeat=20;repeatInterval=2} @forward
  - state{s=flap;r=true} @self
  - state{s=turnright} @self
  - effect:spin{duration=15;velocity=10} @self
  
  
  
##### COMBAT STUFF #####

mortosBREATH:
  Conditions:
  - stance{s=flight} true
  Skills:
  - effect:particles{p=flash;a=1;hs=.25;vs=.25} @ModelPart{m=mortos;p=jaw}
  - missile{sE=false;ot=mortosBREATH_TICK;oE=mortosBREATH_HIT_GROUND;v=12;i=1;hR=1;vR=1;in=0.75;sfo=5;in=50} 
  - sound{s=littleroom_mortos:littleroom.mortos.mortosbreath;v=1;sc=HOSTILE} @self
  
  


mortosBREATH_TICK:
  Skills:
  - effect:particles{p=soul_fire_flame;a=25;hs=.25;vs=.25} @origin

  
mortosBREATH_HIT_GROUND:
  Skills:
  - effect:particles{p=soul;a=50;hS=1;vS=1}
  - effect:sound{s=entity.generic.explode;v=1;p=0}
  - damage{a=80;i=false}
  - effect:blockmask{m=soul_sand;r=2;d=60}
  - summon{t=rotter} @origin{yoffset=-2}
  
##### TARGET BEHIND #####

mortosTARGETBEHIND:
  Conditions:
  #- targetnotinlineofsight true
  Skills:
  - CancelEvent
  - state{s=targetbehind} @self
  - look{headOnly=false;immediately=true;repeat=15;repeatInterval=1} @Target
  
  
##### BITE #####

mortosBITEsync:
  Skills:
  - CancelEvent
  - skill{s=mortosBITE} @self
  
mortosBITE:
  Conditions:
  - onground true
  TargetConditions:
  - targetwithin{d=2} false
  Cooldown: 2
  Skills:
  - sound{s=littleroom_mortos:littleroom.mortos.mortosbite;v=1;sc=HOSTILE} @self
  - look{headOnly=false;immediately=true;repeat=20;repeatInterval=1} @Target
  - setAI{ai=false}
  - state{s=bite} @self
  - delay 10
  - totem{ch=15;oH=mortosBITEdamage;int=1;hR=2;vR=2;md=2;repeat=15;repeatInterval=1;hp=true} @ModelPart{m=mortos;p=jaw}
  - delay 5
  - setAI{ai=true}
  
mortosBITEdamage:
  Skills:
  - damage{amount=60}
  - effect:particles{p=reddust;color=#CC0000;amount=2;hS=.25;vS=1;speed=.01;size=5}
  - effect:particles{particle=block;m=redstone_block;;amount=15;hS=.25;vS=1;speed=.01;size=5}
  - delay 5   
  - throw{velocity=5;velocityY=5}


##### TAILWHIP #####

mortosWHIPsync:
  Skills:
  - CancelEvent
  - skill{s=mortosWHIP} @self
  
mortosWHIP:
  Conditions:
  - onground true
  TargetConditions:
  - targetnotwithin{d=6} false
  Cooldown: 2
  Skills:
  - sound{s=littleroom_mortos:littleroom.mortos.mortostail;v=1;sc=HOSTILE} @self
  - look{headOnly=false;immediately=true;repeat=20;repeatInterval=1} @Target
  - state{s=tailswipe} @self
  - delay 10
  - totem{ch=15;oH=mortosWHIPdamage;int=1;hR=2;vR=2;md=2;repeat=15;repeatInterval=1;hp=true} @ModelPart{m=mortos;p=tail4}
  - delay 10
  - jump{velocity=0.25} @self
  
mortosWHIPdamage:
  Skills:
  - damage{amount=40}
  - effect:particles{p=reddust;color=#CC0000;amount=2;hS=.25;vS=1;speed=.01;size=5}
  - effect:particles{particle=block;m=redstone_block;;amount=15;hS=.25;vS=1;speed=.01;size=5}
  - throw{velocity=5;velocityY=5}
  
  
mortosDEATH:
  Skills:
  - sound{s=littleroom_mortos:littleroom.mortos.mortosdeath;v=1;sc=HOSTILE} @self
  - delay 35
  - sound{s=littleroom_mortos:littleroom.mortos.mortosland;v=1;sc=HOSTILE} @self
  - delay 25
  - sound{s=littleroom_mortos:littleroom.mortos.poof;v=1;sc=HOSTILE} @self
  - effect:particles{p=reddust;color=#000000;amount=500;hS=2;vS=1;speed=.01;size=5} @self
  
mortosDEATH_AIR:
  Conditions:
  - altitude{a=>3} true
  Skills:
  - model{mid=mortos;r=true} @self
  - summon{t=fallingmortos} @self
  
fallingmortosSPAWN:
  Skills:
  - delay 1
  - state{s=deathair} @self
  
fallingmortosLAND:
  Cooldown: 10
  Conditions:
  - onground
  Skills:    
  - sound{s=littleroom_mortos:littleroom.mortos.mortosland;v=1;sc=HOSTILE} @self
  - throw{velocity=10;velocityY=3} @PIR{r=5}
  - state{s=deathland} @self
  - delay 40
  - effect:particles{p=reddust;color=#000000;amount=500;hS=2;vS=1;speed=.01;size=5} @self
  - sound{s=littleroom_mortos:littleroom.mortos.poof;v=1;sc=HOSTILE} @self
  - remove @self
  
#### ROTTER ####
rotterSPAWN:
  Skills:
  - delay 1
  - sound{s=littleroom_mortos:littleroom.mortos.rotterspawn;v=1;sc=HOSTILE} 
  - setAI{ai=false} @self
  - state{s=spawn}
  - delay 2
  - teleport{spreadh=0;spreadv=0} @origin{yoffset=2}
  - delay 20
  - setAI{ai=true} @self


rotterLEAP:
  Cooldown: 4
  Conditions:
  - onground true
  TargetConditions:
  - targetwithin{d=8} false
  Skills:
  - state{s=jump} @self
  - delay 10  
  - look{headOnly=false;immediately=true;repeat=40;repeatInterval=1} @Target
  - lunge{velocity=3;velocityY=1} @target
  - state{s=inair} @self
  - setstance{stance=leap} @self
  - lunge{velocity=2;velocityY=.25} @target
  - delay 5
  
  
rotterLAND:
  Conditions:
  - stance{s=leap} true
  - onground
  Skills:
  - setAI{AI=false}
  - state{s=inair;r=true} @self
  - state{s=land} @self
  - setstance{stance=land} @self
  - delay 10
  - setAI{AI=true}
  
  
rotterATTACK1:
  Skills:
  - CancelEvent
  - skill{s=rotterATTACKskill} @self

rotterATTACKskill:
 Cooldown: 2
 Skills:  
  - state{s=attack} @self
  - randomskill{skills=rotterSWING1,rotterSWING2,rotterSWING3} @self
  - delay 15
  - totem{ch=15;oH=rotterATTACK1damage;int=1;hR=1;vR=2;md=2;hp=true} @Forward{f=2}


rotterATTACK1damage:
  Skills:
  - damage{amount=20}
  - randomskill{skills=rotterHIT1,rotterHIT2,rotterHIT3} @PIR{r=3}
  - skill{s=rotterSOULRETURN} @parent
  - effect:particles{p=reddust;color=#CC0000;amount=2;hS=.25;vS=1;speed=.01;size=5}
  - effect:particles{particle=block;m=redstone_block;;amount=15;hS=.25;vS=1;speed=.01;size=5}
  
rotterATTACK2:
  Skills:
  - CancelEvent
  - skill{s=rotterATTACK2skill} @self

rotterATTACK2skill:
  Cooldown: 2
  Skills:
  - state{s=attack2} @self
  - randomskill{skills=rotterSWING1,rotterSWING2,rotterSWING3} @self
  - delay 15
  - totem{ch=15;oH=rotterATTACK2damage;int=1;hR=1;vR=2;md=2;hp=true} @Forward{f=2}

rotterATTACK2damage:
  Skills:
  - damage{amount=20}
  - randomskill{skills=rotterHIT1,rotterHIT2,rotterHIT3} @PIR{r=3}
  - skill{s=rotterSOULRETURN} @parent
  - effect:particles{p=reddust;color=#CC0000;amount=2;hS=.25;vS=1;speed=.01;size=5}
  - effect:particles{particle=block;m=redstone_block;;amount=15;hS=.25;vS=1;speed=.01;size=5}
  
rotterHIT1:
  Skills:
  - sound{s=littleroom_mortos:littleroom.mortos.rotterhit;v=1;sc=HOSTILE} 
  
rotterHIT2:
  Skills:
  - sound{s=littleroom_mortos:littleroom.mortos.rotterhit2;v=1;sc=HOSTILE} 
  
rotterHIT3:
  Skills:
  - sound{s=littleroom_mortos:littleroom.mortos.rotterhit3;v=1;sc=HOSTILE} 
  
rotterSWING1:
  Skills:
  - sound{s=littleroom_mortos:littleroom.mortos.rotterswing;v=1;sc=HOSTILE} 
  
rotterSWING2:
  Skills:
  - sound{s=littleroom_mortos:littleroom.mortos.rotterswing2;v=1;sc=HOSTILE} 
  
rotterSWING3:
  Skills:
  - sound{s=littleroom_mortos:littleroom.mortos.rotterswing3;v=1;sc=HOSTILE} 
  
  
rotterDEATH:
  Skills:
  - sound{s=littleroom_mortos:littleroom.mortos.rotterdeath;v=1;sc=HOSTILE} @self
  - delay 3
  - effect:particles{p=sneeze;amount=15;hS=.25;vS=1;speed=.01;size=5;syo=2} @ModelPart{m=rotter;p=jaw}
  - delay 3
  - effect:particles{p=sneeze;amount=15;hS=.25;vS=1;speed=.01;size=5;syo=2} @ModelPart{m=rotter;p=righthand}
  - delay 3
  - effect:particles{p=sneeze;amount=15;hS=.25;vS=1;speed=.01;size=5;syo=2} @ModelPart{m=rotter;p=leftleg}
  - delay 3
  - effect:particles{p=sneeze;amount=15;hS=.25;vS=1;speed=.01;size=5;syo=2} @ModelPart{m=rotter;p=head}
  - delay 3
  - effect:particles{p=sneeze;amount=15;hS=.25;vS=1;speed=.01;size=5;syo=2} @ModelPart{m=rotter;p=rotter}
  - delay 25
  - effect:particles{p=cloud;amount=50;hS=1;vS=.25;speed=.01;size=5;syo=2} @ModelPart{m=rotter;p=rotter}
  - sound{s=littleroom_mortos:littleroom.mortos.poof;v=1;sc=HOSTILE} @self

rotterSOULRETURN:
  Skills:
  - missile{ot=rotterSOULRETURN_TICK;oh=rotterSOULHEAL;v=12;i=1;hR=1;vR=1;in=0.75;hnp=true;hp=false}

rotterSOULRETURN_TICK:
  Skills:
  - effect:particles{p=soul;a=2;hs=.25;vs=.25} @origin
  
rotterSOULHEAL:
  Skills:
  - heal{amount=1}


